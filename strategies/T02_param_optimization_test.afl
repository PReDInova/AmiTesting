// ===========================================
// T02 - Parameter & Optimization Test
// ===========================================
//
// Simple SMA crossover strategy with optimizable parameters.
// No TimeFrameSet, no session filters, no indicators -- just two
// moving averages crossing. Use this to verify:
//   - Parameter runs (run_mode=2): backtest with fixed defaults
//   - Optimization runs (run_mode=4): sweep all param combos
//   - SQL persistence of optimization combo results
//
// Parameters:
//   FastPeriod: 5  (range 3-9, step 2)  -> values: 3, 5, 7, 9
//   SlowPeriod: 20 (range 15-25, step 5) -> values: 15, 20, 25
//   Total optimization combos: 4 x 3 = 12
//
// Expected: different parameter combos produce different trade counts
// and profit figures because the crossover timing changes.

// ---- Strategy Parameters ----
FastPeriod = Param("FastPeriod", 5, 3, 9, 2);
SlowPeriod = Param("SlowPeriod", 20, 15, 25, 5);

// ---- Moving Averages ----
fastMA = MA(Close, FastPeriod);
slowMA = MA(Close, SlowPeriod);

// ---- Entry / Exit Signals ----
Buy  = Cross(fastMA, slowMA);
Sell = Cross(slowMA, fastMA);

// No short trades -- keep it simple
Short = 0;
Cover = 0;

// ---- Position sizing: 1 contract ----
SetPositionSize(1, spsShares);

// ---- Remove excess signals ----
Buy  = ExRem(Buy, Sell);
Sell = ExRem(Sell, Buy);

// ---- Visualization ----
Plot(Close, "Price", colorDefault, styleCandle);
Plot(fastMA, "Fast MA(" + NumToStr(FastPeriod, 1.0) + ")", colorGreen, styleLine);
Plot(slowMA, "Slow MA(" + NumToStr(SlowPeriod, 1.0) + ")", colorBlue, styleLine);
PlotShapes(Buy * shapeUpArrow, colorGreen, 0, Low, -12);
PlotShapes(Sell * shapeDownArrow, colorRed, 0, High, -12);

Title = Name() + " | T02 Param Test | Fast=" + NumToStr(FastPeriod, 1.0) +
        " Slow=" + NumToStr(SlowPeriod, 1.0);
